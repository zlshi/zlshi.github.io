<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/blog/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/blog/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/blog/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/blog/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="编程语言, 操作系统, 算法, 生活, 炼丹, Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="MarginStone&#39;s blog">
<meta property="og:url" content="http://www.iaihe.cn/blog/page/2/index.html">
<meta property="og:site_name" content="MarginStone&#39;s blog">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="MarginStone&#39;s blog">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/blog/',
    scheme: 'Gemini',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":true},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.iaihe.cn/blog/page/2/"/>





  <title>MarginStone's blog</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?b6e32040595c97e2ab9b9ab86d76040c";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/blog/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">MarginStone's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">记录点滴-旺仔&AD钙</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/blog/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/blog/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/blog/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/blog/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/blog/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.iaihe.cn/blog/blog/2016/04/24/java-e4-b8-ad-e5-85-8b-e9-9a-86-e4-b8-8e-e6-8b-b7-e8-b4-9d-e6-9e-84-e9-80-a0-e5-87-bd-e6-95-b0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zlshi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MarginStone's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2016/04/24/java-e4-b8-ad-e5-85-8b-e9-9a-86-e4-b8-8e-e6-8b-b7-e8-b4-9d-e6-9e-84-e9-80-a0-e5-87-bd-e6-95-b0/" itemprop="url">Java中克隆与拷贝构造函数</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-04-24T16:22:52+08:00">
                2016-04-24
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/Java基础/" itemprop="url" rel="index">
                    <span itemprop="name">Java基础</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>参考<a href="http://howtodoinjava.com/core-java/cloning/a-guide-to-object-cloning-in-java/" target="_blank" rel="external">A Guide to Object Cloning in Java</a><br><a href="https://www.javacodegeeks.com/2014/01/which-is-better-option-cloning-or-copy-constructors.html" target="_blank" rel="external">Which is better option: Cloning or Copy constructors?</a></p>
<h1 id="Cloning-含义"><a href="#Cloning-含义" class="headerlink" title="Cloning 含义"></a>Cloning 含义</h1><p>当我们使用clone()方法时，JVM做如下两件事：<br>1. 如果这个类只包含原始数据类型成员，则创建一个对象的拷贝，原始数据成员被依次拷贝，返回指向新对象的Reference<br>2. 如果类还包括引用数据类型则只拷贝了它的引用，没有开辟新的空间。</p>
<h1 id="Java中的Clone"><a href="#Java中的Clone" class="headerlink" title="Java中的Clone"></a>Java中的Clone</h1><p>java中的类要支持clone需要实现如下两条<br>1. 实现Cloneable接口<br>2. 重写clone()方法<br>Java docs about clone() method are given below (formatted and extract).</p>
<pre>
/*
Creates and returns a copy of this object. The precise meaning of "copy" may depend on the class of the object.
The general intent is that, for any object x, the expression:
1) x.clone() != x will be true
2) x.clone().getClass() == x.getClass() will be true, but these are not absolute requirements.
3) x.clone().equals(x) will be true, this is not an absolute requirement.
*/
protected native Object  [More ...] clone() throws CloneNotSupportedException;
</pre>

<ol>
<li>第一条保证克隆对象和原对象在内存的不同地方（内存地址不一样）</li>
<li>第二条建议克隆对象和原始对象有相同的类类型，但不强制</li>
<li>第三条建议克隆对象和原始对象使用equals比较是形同，但也不强制</li>
</ol>
<p>例子： string也会被拷贝是因为String类是不可变的,对String类的任何改变,都是返回一个新的String类对象<br>Our first class is Employee class with 3 attributes. Id, name and department.</p>
<pre>
public class Employee implements Cloneable{

    private int employeeId;
    private String employeeName;
    private Department department;

    public Employee(int employeeId, String employeeName, Department department) {
        this.employeeId = employeeId;
        this.employeeName = employeeName;
        this.department = department;
    }
    @Override
    public Object clone() throws CloneNotSupportedException
    {
        return super.clone();
    }
    public int getEmployeeId() {
        return employeeId;
    }
    public void setEmployeeId(int employeeId) {
        this.employeeId = employeeId;
    }
    public String getEmployeeName() {
        return employeeName;
    }
    public void setEmployeeName(String employeeName) {
        this.employeeName = employeeName;
    }
    public Department getDepartment() {
        return department;
    }

    public void setDepartment(Department department) {
        this.department = department;
    }
}
</pre>

<pre>
class Department
{
    private int id;
    private String name;

    public Department(int id, String name) {
        this.id = id;
        this.name = name;
    }

    public int getId() {
        return id;
    }

    public void setId(int id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }   
}
</pre>

<p>测试类</p>
<pre>
public class TestCloning {

    public static void main(String[] args) throws CloneNotSupportedException {
        Department dept = new Department(1,"Human Resource");
        Employee original = new Employee(1,"Admin",dept);

        //clone original 
        Employee cloned = (Employee)original.clone();
        System.out.println(cloned.getEmployeeId());

        System.out.println(original != cloned);

        System.out.println(original.getClass()== cloned.getClass());
        System.out.println(original.equals(cloned));
    }
}
</pre>

<p><a href="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160424181932.png" target="_blank" rel="external"><img src="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160424181932.png" alt="QQ截图20160424181932"></a></p>
<p>把String改为StringBuilder就不能实现拷贝</p>
<p>现在我们修改Department会发现 original数据也会被修改</p>
<pre>
public class TestCloning {

    public static void main(String[] args) throws CloneNotSupportedException {
        Department dept = new Department(1,"Human Resource");
        Employee original = new Employee(1,"Admin",dept);

        //clone original 
        Employee cloned = (Employee)original.clone();

        cloned.getDepartment().setName("Software Development");
        System.out.println(original.getDepartment().getName());
    }
}
</pre>

<p><a href="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160424182455.png" target="_blank" rel="external"><img src="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160424182455.png" alt="QQ截图20160424182455"></a></p>
<p>Cloned object changes are visible in original also. This way cloned objects can make havoc in system if allowed to do so. Anybody can come and clone your application objects and do whatever he likes.</p>
<h1 id="浅拷贝"><a href="#浅拷贝" class="headerlink" title="浅拷贝"></a>浅拷贝</h1><p>是Java中默认实现方式，上面例子实现的就是浅拷贝，因为我们在Employee类的克隆方法中没有克隆 Department.</p>
<h1 id="深拷贝"><a href="#深拷贝" class="headerlink" title="深拷贝"></a>深拷贝</h1><p>使在克隆对象上的改变不影响original</p>
<p>修改Employee的克隆方法</p>
<pre>
@Override
    public Object clone() throws CloneNotSupportedException
    {
        Employee cloned = (Employee)super.clone();
        cloned.setDepartment((Department)cloned.getDepartment().clone());
        return cloned;
    }
</pre>

<p>同时Department也要实现clone()方法</p>
<pre>
 @Override
    public Object clone() throws CloneNotSupportedException
    {
        return super.clone();
    }
</pre>

<p>测试：</p>
<pre>
public class TestCloning {

    public static void main(String[] args) throws CloneNotSupportedException {
        Department dept = new Department(1,"Human Resource");
        Employee original = new Employee(1,"Admin",dept);

        //clone original 
        Employee cloned = (Employee)original.clone();

        cloned.getDepartment().setName("Software Development");
        System.out.println(original.getDepartment().getName());

        System.out.println(cloned.getDepartment().getName());
    }
}
</pre>

<p><a href="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160424183921-1.png" target="_blank" rel="external"><img src="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160424183921-1.png" alt="QQ截图20160424183921"></a></p>
<p>这时改变cloned的状态 不改变original的状态</p>
<p>实现深拷贝需要满足如下规则<br>1. No need to separately copy primitives.<br>2. All the member classes in original class should support cloning and in clone method of original class in context should call super.clone() on all member classes.<br>3. If any member class does not support cloning then in clone method, one must create a new instance of that member class and copy all its attributes one by one to new member class object. This new member class object will be set in cloned object.</p>
<h1 id="使用拷贝构造函数"><a href="#使用拷贝构造函数" class="headerlink" title="使用拷贝构造函数"></a>使用拷贝构造函数</h1><pre>
public class PointOne {

    private Integer x;
    private Integer y;
    public PointOne (PointOne point)
    {
        this.x = point.x;
        this.y = point.y;
    }
}
</pre>

<p>通过拷贝构造函数可以得到状态一致的对象</p>
<p>详见参考链接一</p>
<h1 id="通过序列化克隆"><a href="#通过序列化克隆" class="headerlink" title="通过序列化克隆"></a>通过序列化克隆</h1><p>只要对应的类是可序列化的可以通过序列化机制实现克隆，做法： 直接将对象序列化到输出流中，然后将其读回。这样产生的新对象是对现有对象的一个深拷贝。可用ByteArrayOutputStream将数据保存到字节数组中。<br> 但是 它通常会比显示地构建新对象并复制或克隆数据域的克隆方法慢的多，并且并不是所有对象是可序列化的，最后使类可序列化是很困难的，并不是所有的类都可以指望得到它的权利。</p>
<pre>
 class Employee extends SerialCloneable
{
    private String name;
    private double salary;
    private Date hireDay;

    public Employee(String n,double s,int year,int month,int day)
    {
        name = n;
        salary  = s;
        GregorianCalendar calendar = new GregorianCalendar(year,month-1,day);
        hireDay = calendar.getTime();
    }
    public String getName()
    {
        return name;
    }
    public double getSalary()
    {
        return salary;
    }
    public Date getHireDay()
    {
        return hireDay;
    }
    public void raiseSalay(double byPercent)
    {
        double raise = salary*byPercent/100.0;
        salary += raise;
    }
    public String toString()
    {
        return getClass().getName()+
                "[name="+name
                +",salary="+salary
                +",hireDay="+hireDay
                +"]";
    }
}
 </pre>

<pre>
 class SerialCloneable implements Cloneable,Serializable
{
    @Override
    public Object clone()
    {
        try{
        //save the object to a byte array
        ByteArrayOutputStream bout = new ByteArrayOutputStream();
        ObjectOutputStream out = new ObjectOutputStream(bout);
        out.writeObject(this);
        out.close();

        //read a clone of the object from the byte array
        ByteArrayInputStream bin = new ByteArrayInputStream(bout.toByteArray());
        ObjectInputStream in = new ObjectInputStream(bin);
        Object ret = in.readObject();
        in.close();
        return ret;
        }catch(Exception e)
        {
            e.printStackTrace();
            return null;
        }
    }
}
 </pre>

<pre>
 public class SerialCloneTest {

    public static void main(String[] args) {
        Employee harry = new Employee("Harry Hacker",35000,1989,10,1);

        Employee harry2 = (Employee)harry.clone();
        harry2.raiseSalay(10);

        System.out.println(harry);
        System.out.println(harry2);
    }

}
 </pre>

<p><a href="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/2016-04-24_195601.png" target="_blank" rel="external"><img src="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/2016-04-24_195601.png" alt="2016-04-24_195601"></a></p>
<h1 id="使用Apache工具包-using-Apache-commons"><a href="#使用Apache工具包-using-Apache-commons" class="headerlink" title="使用Apache工具包(using Apache commons)"></a>使用Apache工具包(using Apache commons)</h1><p>Apache commons has also utility function for deep cloning. If you feel interested the follow their official docs. Below is sample usage of cloning facility using Apache commons:</p>
<pre>
 SomeObject cloned = org.apache.commons.lang.SerializationUtils.clone(someObject);
 </pre>

<h1 id="Best-practices"><a href="#Best-practices" class="headerlink" title="Best practices"></a>Best practices</h1><ul>
<li>When you don’t know whether you can call the clone() method of a particular class as you are not sure if it is implemented in that class, you can check with checking if the class is instance of “Cloneable” interface as below.</li>
</ul>
<pre>
if(obj1 instanceof Cloneable){
    obj2 = obj1.clone();
} 
//Dont do this. Cloneabe dont have any methods
obj2 = (Cloneable)obj1.clone();
</pre>

<ul>
<li>No constructor is called on the object being cloned. As a result, it is your responsibility, to make sure all the members have been properly set. Also, if you are keeping track of number of objects in system by counting the invocation of constructors, you got a new additional place to increment the counter.</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.iaihe.cn/blog/blog/2016/04/24/prototype-pattern-e5-8e-9f-e5-9e-8b-e6-a8-a1-e5-bc-8f/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zlshi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MarginStone's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2016/04/24/prototype-pattern-e5-8e-9f-e5-9e-8b-e6-a8-a1-e5-bc-8f/" itemprop="url">Prototype Pattern(原型模式)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-04-24T14:13:32+08:00">
                2016-04-24
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/设计模式/" itemprop="url" rel="index">
                    <span itemprop="name">设计模式</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>参考<a href="https://sourcemaking.com/design_patterns/prototype" target="_blank" rel="external">Prototype Design Pattern</a><br><a href="https://yq.aliyun.com/articles/32049" target="_blank" rel="external">Factory模式与Prototype模式的异同</a></p>
<h2 id="the-prototype-is-the-object-containing-clone-method-used-to-clone-similar-objects-to-it-for-reducing-the-number-of-classes"><a href="#the-prototype-is-the-object-containing-clone-method-used-to-clone-similar-objects-to-it-for-reducing-the-number-of-classes" class="headerlink" title="the prototype is the object containing clone method used to clone similar objects to it for reducing the number of classes"></a>the prototype is the object containing clone method used to clone similar objects to it for reducing the number of classes</h2><h2 id="a-solution-to-these-problems"><a href="#a-solution-to-these-problems" class="headerlink" title="a solution to these problems"></a>a solution to these problems</h2><p>How does one reduce the number of classes that share similar behavoir and relationships</p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>Define a class to replace all the classes that share similar behavior and relationships. Save instances,called prototypes,of this class. To create an instance of any of the classes replaced, simply clone the desired prototype and modify its attributes</p>
<h2 id="Liabilities-缺点"><a href="#Liabilities-缺点" class="headerlink" title="Liabilities(缺点)"></a>Liabilities(缺点)</h2><ol>
<li>The subclasses of prototype must implement the clone() method. This requires deep-copying if the instances and original must be independent;otherwise, shallow-copying is sufficient</li>
<li>Implementing clone() may be difficult or impossible if the class is final or there are circular references  循环引用 无法克隆</li>
</ol>
<h2 id="Example-Prototype-in-Java"><a href="#Example-Prototype-in-Java" class="headerlink" title="Example Prototype in Java"></a>Example Prototype in Java</h2><ol>
<li>Create a “contract” with clone() and getName() entries</li>
<li>Design a “registry” that maintains a cache of prototypical objects</li>
<li>Populate the registry with an initializePrototypes() function</li>
<li>The registry has a findAndClone() “virtual constructor” that can transform a String into its correct object (it calls clone() which then calls “new”)</li>
<li>All classes relate themselves to the clone() contract</li>
<li>Client uses the findAndClone() virtual ctor instead of the “new” operator</li>
</ol>
<pre>
package Prototype;
interface Prototype {
    Object clone();
    String getName();
}
</pre>

<p>//1.The clone() contract</p>
<pre>
interface Command
{
    void execute();
}
</pre>

<pre><code>class PrototypesModule
{
    //2\. &quot;registry&quot; of prototypical objs
    private static Prototype[] prototypes = new Prototype[9];
    private static int total = 0;

    // Adds a feature to the Prototype attribute of the PrototypesModule class
    //obj The feature to be added to the Prototype attribute
    public static void addPrototype(Prototype obj)
    {
        prototypes[total++] = obj;
    }
    public static Object findAndClone(String name)
    {
        //4\. The &quot;virtual ctor&quot;
        for(int i=0;i&amp;lt;total;i++)
        {
            if(prototypes[i].getName().equals(name))
                return prototypes[i].clone();
        }
        System.out.println(name + &quot;not found&quot;);
        return null;
    }
}
//5\. Sign-up for the clone() contract
`&lt;/pre&gt;

&lt;/pre&gt;

&lt;pre&gt;
class This implements Prototype,Command
{
    public Object clone()
    {
        return new This();
    }
    public String getName()
    {
        return &quot;This&quot;;
    }
    public void execute()
    {
        System.out.println(&quot;This:execute&quot;);
    }
}
&lt;/pre&gt;

&lt;pre&gt;
class That implements Prototype,Command
{
    public Object clone()
    {
        return new That();
    }
    public String getName()
    {
        return &quot;That&quot;;
    }
    public void execute()
    {
        System.out.println(&quot;That:execute&quot;);
    }
}
&lt;/pre&gt;

&lt;pre&gt;
class TheOther implements Prototype,Command
{
    public Object clone()
    {
        return new TheOther();
    }
    public String getName()
    {
        return &quot;TheOther&quot;;
    }
    public void execute()
    {
        System.out.println(&quot;TheOther:execute&quot;);
    }
}
&lt;/pre&gt;

&lt;pre&gt;`public class PrototypeDemo {
    //3\. Populate the &quot;registry&quot;
    public static void initializePrototypes()
    {
        PrototypesModule.addPrototype(new This());
        PrototypesModule.addPrototype(new That());
        PrototypesModule.addPrototype(new TheOther());
    }

    public static void main(String[] args) {
        initializePrototypes();
        Object[] objects = new Object[9];
        int total = 0;
        // 6\. Client does not use &quot;new&quot;
        for(int i=0;i&amp;lt;args.length;i++)
        {
            objects[total] = PrototypesModule.findAndClone(args[i]);
            if(objects[total]!=null) total++;
        }
        for(int i=0;i&amp;lt;total;i++)
        {
            ((Command)objects[i]).execute();
        }       
    }
}
</code></pre><p></p>
<p><a href="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/2016-04-24_154950.png" target="_blank" rel="external"><img src="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/2016-04-24_154950.png" alt="2016-04-24_154950"></a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.iaihe.cn/blog/blog/2016/04/19/singleton-e8-ae-be-e8-ae-a1-e6-a8-a1-e5-bc-8f/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zlshi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MarginStone's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2016/04/19/singleton-e8-ae-be-e8-ae-a1-e6-a8-a1-e5-bc-8f/" itemprop="url">Singleton设计模式</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-04-19T13:10:09+08:00">
                2016-04-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/设计模式/" itemprop="url" rel="index">
                    <span itemprop="name">设计模式</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>参考<br>Efficetive Java  page14<br><a href="http://coolshell.cn/articles/265.html" target="_blank" rel="external">深入浅出单实例Singleton设计模式</a><br><a href="http://wuchong.me/blog/2014/08/28/how-to-correctly-write-singleton-pattern/" target="_blank" rel="external">如何正确地写出单例模式</a></p>
<h1 id="Singleton-1-0版本"><a href="#Singleton-1-0版本" class="headerlink" title="Singleton 1.0版本"></a>Singleton 1.0版本</h1><pre>
public class Singleton {
    private static Singleton instance =null;
    private Singleton()
    {
        System.out.println("Singleton 实例化");
    }
    public static Singleton getInstance()
    {
        if(instance==null){
            instance = new Singleton();
        }
        return instance;
    }
}
</pre>

<h2 id="Singleton的特点"><a href="#Singleton的特点" class="headerlink" title="Singleton的特点"></a>Singleton的特点</h2><ol>
<li>私有（private）的构造函数，表明这个类是不可能形成实例了。这主要是怕这个类会有多个实例。</li>
<li>即然这个类是不可能形成实例，那么，我们需要一个静态的方式让其形成实例：getInstance()。注意这个方法是在new自己，因为其可以访问私有的构造函数，所以他是可以保证实例被创建出来的。</li>
<li>在getInstance()中，先做判断是否已形成实例，如果已形成则直接返回，否则创建实例。</li>
<li>所形成的实例保存在自己类中的私有成员中。</li>
<li>我们取实例时，只需要使用Singleton.getInstance()就行了。</li>
</ol>
<h2 id="单线程下"><a href="#单线程下" class="headerlink" title="单线程下"></a>单线程下</h2><p>测试代码：</p>
<pre>
public class Tests {

    public static void main(String[] args) {
        for(int i=1;i<=1000;i++) {="" object相同则hashcode一样="" system.out.println(singleton.getinstance().hashcode());="" }="" <="" pre="">

<p>测试结果<br><a href="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/2016-04-19_132745.png" target="_blank" rel="external"><img src="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/2016-04-19_132745.png" alt="2016-04-19_132745"></a></p>
<h2 id="多线程下"><a href="#多线程下" class="headerlink" title="多线程下"></a>多线程下</h2><p>测试代码：</p>
<pre>
public class Tests {

    public static void main(String[] args) {
        TestSingletonThread T[]=new TestSingletonThread[101];
        for(int i=1;i<=100;i++) {="" t[i]="new" testsingletonthread();="" t[i].start();="" }="" class="" testsingletonthread="" extends="" thread="" @override="" public="" void="" run()="" system.out.println(singleton.getinstance().hashcode());="" <="" pre="">

<p>测试结果：<br><a href="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/2016-04-19_133750.png" target="_blank" rel="external"><img src="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/2016-04-19_133750.png" alt="2016-04-19_133750"></a></p>
<p>可以发现在多线程下会实例化多个实例</p>
<h1 id="Singleton-1-1版本"><a href="#Singleton-1-1版本" class="headerlink" title="Singleton 1.1版本"></a>Singleton 1.1版本</h1><p>因为在多线程下会实例化多个实例，所以加入synchronized关键字</p>
<pre>
public class Singleton {
    private static Singleton instance =null;
    private Singleton()
    {
        System.out.println("Singleton 实例化");
    }
    public static  synchronized Singleton getInstance()
    {
        if(instance==null){
            instance = new Singleton();
        }
        return instance;
    }
}
</pre>

<p>但是此时在多线程下，当已经实例化一份实例后，之后的线程再去获得实例应该是并行的，而加上synchronized关键字后变成并行 影响程序性能<br>因为自己电脑为4线程所以开4个线程去获取Singleton的实例，来展示性能差异<br>代码</p>
<pre>
public class Tests {

    public static void main(String[] args) throws InterruptedException {
        TestSingletonThread T[]=new TestSingletonThread[5];
        long start,end;
        start = System.nanoTime();
        for(int i=1;i<=4;i++) {="" t[i]="new" testsingletonthread();="" t[i].start();="" }="" for(int="" i="1;i<=4;i++)" t[i].join();="" end="System.nanoTime();" system.out.println("运行时间"+(end-start)="" 1000.0+"微秒");="" class="" testsingletonthread="" extends="" thread="" @override="" public="" void="" run()="" system.out.println(singleton.getinstance().hashcode());="" <="" pre="">

<h2 id="不加synchronized关键字-但会实例化多个"><a href="#不加synchronized关键字-但会实例化多个" class="headerlink" title="不加synchronized关键字 但会实例化多个"></a>不加synchronized关键字 但会实例化多个</h2><p><a href="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160419214859.png" target="_blank" rel="external"><img src="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160419214859.png" alt="QQ截图20160419214859"></a></p>
<p><a href="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160419215011.png" target="_blank" rel="external"><img src="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160419215011.png" alt="QQ截图20160419215011"></a></p>
<h2 id="加synchronized关键字-不会实例化多个-但会损耗性能"><a href="#加synchronized关键字-不会实例化多个-但会损耗性能" class="headerlink" title="加synchronized关键字  不会实例化多个 但会损耗性能"></a>加synchronized关键字  不会实例化多个 但会损耗性能</h2><p><a href="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160419214736.png" target="_blank" rel="external"><img src="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160419214736.png" alt="QQ截图20160419214736"></a></p>
<p><a href="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160419214826.png" target="_blank" rel="external"><img src="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160419214826.png" alt="QQ截图20160419214826"></a></p>
<h1 id="Singleton1-2版本"><a href="#Singleton1-2版本" class="headerlink" title="Singleton1.2版本"></a>Singleton1.2版本</h1><p>为了改善性能同时又不实例化多个Singleton实例，可以使用双重检测(Double-Check)</p>
<p>代码</p>
<pre>
public class Singleton {
    private static Singleton instance =null;
    private Singleton()
    {
        System.out.println("Singleton 实例化");
    }
    public static Singleton getInstance()
    {

        if(instance==null){
            synchronized(Singleton.class){
                if(instance == null)
                    instance = new Singleton();
            }       
        }   
        return instance;
    }
}
</pre>

<p>说明<br>1. 第一个条件是说，如果实例创建了，那就不需要同步了，直接返回就好了。<br>2. 不然，我们就开始同步线程。<br>3. 第二个条件是说，如果被同步的线程中，有一个线程创建了对象，那么别的线程就不用再创建了。<br>但是，如果你认为这个版本大攻告成，你就错了。</p>
<p>主要在于singleton = new Singleton()这句，这并非是一个原子操作，事实上在 JVM 中这句话大概做了下面 3 件事情。</p>
<ol>
<li>给 singleton 分配内存</li>
<li>调用 Singleton 的构造函数来初始化成员变量，形成实例</li>
<li>将singleton对象指向分配的内存空间（执行完这步 singleton才是非 null 了）</li>
</ol>
<p>但是在 JVM 的即时编译器中存在指令重排序的优化。也就是说上面的第二步和第三步的顺序是不能保证的，最终的执行顺序可能是 1-2-3 也可能是 1-3-2。如果是后者，则在 3 执行完毕、2 未执行之前，被线程二抢占了，这时 instance 已经是非 null 了（但却没有初始化），所以线程二会直接返回 instance，然后使用，然后顺理成章地报错。</p>
<p>对此，我们只需要把singleton声明成 volatile 就可以了。下面是1.3版：</p>
<h1 id="Singleton-1-3版本"><a href="#Singleton-1-3版本" class="headerlink" title="Singleton 1.3版本"></a>Singleton 1.3版本</h1><p>代码</p>
<pre>
public class Singleton {
    private volatile static Singleton instance =null;
    private Singleton()
    {
        System.out.println("Singleton 实例化");
    }
    public static Singleton getInstance()
    {

        if(instance==null){
            synchronized(Singleton.class){
                if(instance == null)
                    instance = new Singleton();
            }       
        }   
        return instance;
    }
}
</pre>

<p>使用 volatile 有两个功用：</p>
<p>1）这个变量不会在多个线程中存在复本，直接从内存读取。</p>
<p>2）这个关键字会禁止指令重排序优化。也就是说，在 volatile 变量的赋值操作后面会有一个内存屏障（生成的汇编代码上），读操作不会被重排序到内存屏障之前。</p>
<p>但是，这个事情仅在Java 1.5版后有用，1.5版之前用这个变量也有问题，因为老版本的Java的内存模型是有缺陷的。</p>
<h1 id="Singleton-1-4版本"><a href="#Singleton-1-4版本" class="headerlink" title="Singleton 1.4版本"></a>Singleton 1.4版本</h1><p>这种方法非常简单，因为单例的实例被声明成 static 和 final 变量了，在第一次加载类到内存中时就会初始化，所以创建实例本身是线程安全的。</p>
<pre>
 public class Singleton {
    private  static final Singleton instance = new Singleton();
    private Singleton()
    {
        System.out.println("Singleton 实例化");
    }
    public static Singleton getInstance()
    {   
        return instance;
    }
}
</pre>

<p>但是，这种玩法的最大问题是——当这个类被加载的时候，new Singleton() 这句话就会被执行，就算是getInstance()没有被调用，类也被初始化了。</p>
<p>于是，这个可能会与我们想要的行为不一样，比如，我的类的构造函数中，有一些事可能需要依赖于别的类干的一些事（比如某个配置文件，或是某个被其它类创建的资源），我们希望他能在我第一次getInstance()时才被真正的创建。这样，我们可以控制真正的类创建的时刻，而不是把类的创建委托给了类装载器。</p>
<h1 id="Singleton-1-5版本"><a href="#Singleton-1-5版本" class="headerlink" title="Singleton 1.5版本"></a>Singleton 1.5版本</h1><p>静态内部类</p>
<pre>
public class Singleton {

    private static class SingletonHolder
    {
        private  static final Singleton instance = new Singleton();
    }
    private Singleton()
    {
        System.out.println("Singleton 实例化");
    }
    public static final Singleton getInstance()
    {   
        return SingletonHolder.instance;
    }
}
</pre>

<p>上面这种方式，仍然使用JVM本身机制保证了线程安全问题；由于 SingletonHolder 是私有的，除了 getInstance() 之外没有办法访问它，因此它只有在getInstance()被调用时才会真正创建；同时读取实例的时候不会进行同步，没有性能缺陷；也不依赖 JDK 版本。</p>
<h1 id="Singleton-1-6-枚举-Enum"><a href="#Singleton-1-6-枚举-Enum" class="headerlink" title="Singleton 1.6 枚举 Enum"></a>Singleton 1.6 枚举 Enum</h1><pre>
public enum Singleton {
    INSTANCE;
    public  void leaveTheBuilding() {
        System.out.println("Whoa baby, I'm outta here!");
    }
}
</pre>

<p>我们可以通过Singleton.INSTANCE来访问实例，这比调用getInstance()方法简单多了。创建枚举默认就是线程安全的，所以不需要担心double checked locking，而且还能防止反序列化导致重新创建新的对象。</p>
<p>#其它问题（参考链接1）</p>
<h2 id="Class-Loader"><a href="#Class-Loader" class="headerlink" title="Class Loader"></a>Class Loader</h2><h2 id="序例化-声明所有实例域都是瞬时的-transient-的-并提供一个readResolve方法"><a href="#序例化-声明所有实例域都是瞬时的-transient-的-并提供一个readResolve方法" class="headerlink" title="序例化 (声明所有实例域都是瞬时的(transient)的 并提供一个readResolve方法"></a>序例化 (声明所有实例域都是瞬时的(transient)的 并提供一个readResolve方法</h2><p>Effective Java 77条</p>
<h2 id="多个Java虚拟机"><a href="#多个Java虚拟机" class="headerlink" title="多个Java虚拟机"></a>多个Java虚拟机</h2><h2 id="volatile变量"><a href="#volatile变量" class="headerlink" title="volatile变量"></a>volatile变量</h2><h2 id="关于代码重用"><a href="#关于代码重用" class="headerlink" title="关于代码重用"></a>关于代码重用</h2></=4;i++)></pre></=100;i++)></pre></=1000;i++)></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.iaihe.cn/blog/blog/2016/04/18/grasp-e9-80-9a-e7-94-a8-e8-81-8c-e8-b4-a3-e5-88-86-e9-85-8d-e8-bd-af-e4-bb-b6-e6-a8-a1-e5-bc-8f/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zlshi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MarginStone's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2016/04/18/grasp-e9-80-9a-e7-94-a8-e8-81-8c-e8-b4-a3-e5-88-86-e9-85-8d-e8-bd-af-e4-bb-b6-e6-a8-a1-e5-bc-8f/" itemprop="url">GRASP通用职责分配软件模式</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-04-18T21:48:36+08:00">
                2016-04-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/设计模式/" itemprop="url" rel="index">
                    <span itemprop="name">设计模式</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://blog.nicky-zs.com/blog/12/" target="_blank" rel="external">GRASP设计模式及OO设计原则</a></p>
<p>GRASP设计模式的全称是General Responsibility Assignment Software Patterns，即通用职责分配软件模式。它定义了9个基本的OO设计原则或基本的设计构件。这9个设计模式分别是：</p>
<ul>
<li>控制器(Controller)</li>
<li>创建者(Creator)</li>
<li>高内聚(High cohesion)</li>
<li>间接性(Indirection)</li>
<li>信息专家(Information expert)</li>
<li>低耦合(Low coupling)</li>
<li>多态(Polymorphism)</li>
<li>预防变化(Protected variations)</li>
<li>纯虚构(Pure fabrication)</li>
</ul>
<h1 id="1-The-Controller-pattern"><a href="#1-The-Controller-pattern" class="headerlink" title="1.The Controller pattern"></a>1.The Controller pattern</h1><ol>
<li>the controller collaborates with the bussiness objects to handle the actor request</li>
<li>the controller delivers the result to the presentation,which displays the result to the actor</li>
<li>为了解决如下问题(a solution to these problems)<br>A. Decouple the presentation and bussiness objects<br> B. Remove the responsibility to handle an actor request from the presentation and assign it to another object</li>
<li>缺点(liabilities)<br>A controller may be assigned too many responsibilities,resulting in a so-called bloated controller</li>
</ol>
<h1 id="2-Creator"><a href="#2-Creator" class="headerlink" title="2.Creator"></a>2.Creator</h1><ol>
<li>the creator is the object that is responsible for creating an object of a class</li>
<li>a solution to these problems,supposed that an object of class A is the creator of an object of class B<br>A. Class A is an aggregation(聚合) of class B<br>B. An object of class A contains objects of class B<br>C. An object of class A records object of class B<br>D. An object of class A closely uses objects of class B<br>E. An object of class A has the information to create objects of class B</li>
<li>缺点(liabilities)<br>One same object may have different creation behaviors</li>
</ol>
<h1 id="3-6-High-cohesion-Low-coupling"><a href="#3-6-High-cohesion-Low-coupling" class="headerlink" title="3 6 High cohesion Low coupling"></a>3 6 High cohesion Low coupling</h1><h1 id="4-Indirection"><a href="#4-Indirection" class="headerlink" title="4 Indirection"></a>4 Indirection</h1><p>间接性模式关注这样一个问题：为了避免两个或多个事务之间直接耦合，应该如何分配职责？如何使对象解耦合，以支持低耦合并提高复用性潜力？</p>
<p>间接性模式对此的回答是：将职责分配给中介对象，使其作为其他构件或服务之间的媒介，以避免它们之间的直接耦合。中介则实现了其他构件之间的间接性。</p>
<p>间接性模式的思想比较简单，即通过一个中介就能消除许多的耦合。在GoF的23种设计模式中，有许多模式都利用到了间接性的思想。比如桥接模式中，设计将抽象部分与其实现部分相分离，利用的就是在客户与实现之间增加了一个抽象层次。外观模式则是在整个子系统与客户之间增加了一个便于用户使用的外观类作为中介。而中介者模式中的中介者则更是典型的例子。</p>
<h1 id="5-The-expert-pattern"><a href="#5-The-expert-pattern" class="headerlink" title="5 The expert pattern"></a>5 The expert pattern</h1><ol>
<li>the expert is the object that is responsible for handling a request should have the information to fulfill the request</li>
<li>a solution to these problems<br>A. who should be assigned the responsibility to handle a request<br> B. Remove the excessive responsibility from the controller and assigning them to other objects</li>
<li>缺点(liabilities)<br>The expert may become a big  object</li>
</ol>
<h1 id="7-多态-Polymorphism"><a href="#7-多态-Polymorphism" class="headerlink" title="7 多态(Polymorphism)"></a>7 多态(Polymorphism)</h1><h1 id="8-预防变化-Protected-variations"><a href="#8-预防变化-Protected-variations" class="headerlink" title="8 预防变化(Protected variations)"></a>8 预防变化(Protected variations)</h1><p>防止变异模式关注这样一个问题：如何设计对象、子系统和系统，使其内部的变化或不稳定性不会对其他元素产生不良影响？</p>
<p>防止变异模式的回答是：识别预计变化或不稳定之处，分配职责用以在这些变化之外创建稳定的接口。</p>
<p>防止变异（PV）是非常重要和基本的软件设计原则，几乎所有的软件或架构设计技巧都是防止变异的特例。PV是一个根本原则，它促成了大部分编程和设计的模式和机制，用来提供灵活性和防止变化。在软件设计中，除了数据封装、接口、多态、间接性等机制是PV的核心机制之外，没有一种固定的或者是通用的办法能够防止一切变化的产生。因此PV的实现依赖的是一系列的OO设计方面的经验性原则，用以产生一个设计良好的高内聚、低耦合的系统，从而支持PV。</p>
<p>这里需要参考文章<a href="https://zlshi.blog.ustc.edu.cn/%e9%9d%a2%e5%90%91%e5%af%b9%e8%b1%a1%e8%ae%be%e8%ae%a1%e5%8e%9f%e5%88%99/" target="_blank" rel="external">面向对象设计原则</a></p>
<h1 id="9-纯虚构-Pure-fabrication"><a href="#9-纯虚构-Pure-fabrication" class="headerlink" title="9 纯虚构(Pure fabrication)"></a>9 纯虚构(Pure fabrication)</h1><p>纯虚构模式关注这样一个问题：当你并不想违背高内聚和低耦合或其他目标，但是基于专家模式所提供的方案又不合适时，哪些对象应该承担这一职责？</p>
<p>OO设计中的领域模型是对领域内的概念内或现实世界中的对象的模型化表示。创建领域模型的关键思想是减小软件人员的思维与软件模式之间的表示差异。因此，在OO设计时，系统内的大多数类都是来源于现实世界中的真实类。然而，在给这些类分配职责时，有可能会遇到一些很难满足低耦合高内聚的设计原则。纯虚构模式对这一问题给出的方案是：给人为制造的类分配一组高内聚的职责，该类并不代表问题领域的概念，而代表虚构出来的事物，用以支持高内聚、低耦合和复用。</p>
<p>纯虚构模式强调的是职责应该置于何处。一般来说，纯虚构模式会通过表示解析或者行为解析来确定出一些纯虚构类，用于放置某一类职责。理想状况下，分配给这种虚构物的职责是要支持高内聚低耦合的，从而使整个系统处于一种良好的设计之中。</p>
<p>例如，在信息专家模式的最后一段所举的例子中提到，许多后台系统都需要对数据库进行操作，将系统中的一些对象进行持久化。信息专家模式给出的建议是将持久化的职责分配给具体的每一个模型类。但是这种建议已经被证明是不符合高内聚低耦合原则的，因为不会被采纳。于是，设计者往往会在系统中加入类似于DAO或者PersistentStorage这样的类。这些类在领域模型中是并不存在的，它们完全由设计者根据系统的行为而虚构得到。然而，这些类的引入，使得操作数据库进行持久化这种高内聚的职责可以顺理成章地分配给它们。从而在整个系统中实现了比较好的内聚和耦合。</p>
<p>在使用纯虚构模式时，不能毫无限制地对系统中的各种行为进行解析并纯虚构。如此往往会导致系统中大量的行为对象的存在，这样会对耦合产生不良的影响。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.iaihe.cn/blog/blog/2016/04/13/jsp-e4-bd-bf-e7-94-a8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zlshi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MarginStone's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2016/04/13/jsp-e4-bd-bf-e7-94-a8/" itemprop="url">JSP使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-04-13T21:53:49+08:00">
                2016-04-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/SSH/" itemprop="url" rel="index">
                    <span itemprop="name">SSH</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Jsp网页的组成"><a href="#Jsp网页的组成" class="headerlink" title="Jsp网页的组成"></a>Jsp网页的组成</h1><h2 id="模板数据"><a href="#模板数据" class="headerlink" title="模板数据"></a>模板数据</h2><p>静态部分，web容器不作处理，如HTML标签。</p>
<h2 id="元素"><a href="#元素" class="headerlink" title="元素"></a>元素</h2><ul>
<li>脚本元素</li>
<li>指令元素</li>
<li>动作元素</li>
</ul>
<h2 id="Jsp-脚本元素类型"><a href="#Jsp-脚本元素类型" class="headerlink" title="Jsp 脚本元素类型"></a>Jsp 脚本元素类型</h2><table border="2"><br><tr><th>脚本元素</th><th>脚本语法</th></tr><br><tr> <td>声明</td> <td> &lt;%! 声明%&gt;</td></tr><br><tr> <td>脚本</td> <td> &lt;% 脚本%&gt;</td></tr><br><tr> <td>脚本表达式</td> <td> &lt;%= 脚本表达式%&gt;</td></tr><br></table>

<p><strong>说明：各个脚本类型的普通格式都有其对应的XML兼容格式，其区别在于：对普通格式页面的访问，会以HTML文件的形式显示，而访问对应的XML兼容格式时，会以XML文件的形式显示。</strong></p>
<h2 id="lt-声明-gt"><a href="#lt-声明-gt" class="headerlink" title="&lt;%!声明%&gt;"></a>&lt;%!声明%&gt;</h2><p>声明语句用于声明方法和变量，对应的XML兼容格式为</p>
<pre> &ltjsp:declaration&gt&lt/jsp:declaration&gt </pre>

<pre><code>                `&amp;lt;html&amp;gt;
                    &amp;lt;head&amp;gt;&amp;lt;title&amp;gt;HelloWorld&amp;lt;/title&amp;gt;&amp;lt;/head&amp;gt;
                    &amp;lt;body&amp;gt;
                        &amp;lt;%! public long fact(long x){//声明
                                if(x == 0) return 1;
                                else return x * fact(x - 1);
                            }       
                        %&amp;gt;
                        &amp;lt;table border=&quot;1&quot;&amp;gt;
                            &amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;x&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;x!&amp;lt;/th&amp;gt;&amp;lt;/tr&amp;gt;
                            &amp;lt;% for(long i = 0; i &amp;lt; 20; i++){  %&amp;gt;&amp;lt;!--脚本--&amp;gt;
                            &amp;lt;tr&amp;gt;
                                &amp;lt;td&amp;gt;&amp;lt;%=i %&amp;gt;&amp;lt;/td&amp;gt;
                                &amp;lt;td&amp;gt;&amp;lt;%=fact(i) %&amp;gt;&amp;lt;/td&amp;gt;
                            &amp;lt;/tr&amp;gt;
                            &amp;lt;%} %&amp;gt;
                        &amp;lt;/table&amp;gt;
                    &amp;lt;/body&amp;gt;
                &amp;lt;/html&amp;gt;`
`&lt;/pre&gt;

// 在声明中定义的变量是翻译成相应Java程序的成员变量, 在脚本中定义的变量是相应Java程序的局部变量。

* * *

* * *

&lt;html&gt;
 &lt;head&gt;&lt;/head&gt;
 &lt;body&gt;

## &lt;%脚本%&gt;

&lt;/body&gt;
 &lt;/html&gt;
</code></pre><ol>
<li>普通格式<pre>`    在&lt;%%&gt;标签里面写入Java代码，访问时以HTML文件的形式呈现。
    '&lt;html&gt;
     &lt;head&gt;&lt;title&gt;HelloWorld&lt;/title&gt;&lt;/head&gt;
    &lt;body&gt;
         &lt;%
         String str = "HelloWorld";
         out.println(str);
        %&gt;
    &lt;/body&gt;
    &lt;/html&gt;'
    说明：脚本翻译成对应java程序的代码放在该java程序的_jspService()方法中，因此，在脚本中声明的变量是局部变量。    `</pre></li>
<li><p>XML兼容格式</p>
<pre>` 在&lt;jsp:scriptlet&gt;&lt;/jsp:scriptlet&gt;标签间写入Java代码，访问时以XML文件的形式呈现。
         示例：
         '&lt;jsp:root xmlns:jsp="http://java.sun.com/JSP/Page" xmlns="http://www.w3.org/1999/xhtml" version="2.0"&gt;                &lt;html&gt;                    &lt;head&gt;&lt;title&gt;Simple jspx page &lt;/title&gt; &lt;/head&gt;                    &lt;body&gt;                    &lt;jsp:scriptlet&gt;                        String str = "hello" ;                        out.println(str) ;                    &lt;/jsp:scriptlet&gt;                    &lt;/body&gt;                &lt;/html&gt;                &lt;/jsp:root&gt;'
`</pre>
<html>
<head></head>
<body><p></p>

## <%=脚本表达式%>

<p></p></%=脚本表达式%></body>
 </html>

<pre>`  脚本表达式用来显示动态生成的结果，对应的XML兼容格式为&lt;jsp:expression&gt;&lt;/jsp:expression&gt;。不能使用分号作为脚本表达式的结束符，脚本表达式可以是常量，也可以是动态计算出来的值。

        示例：
        '&lt;html&gt;
        &lt;head&gt;&lt;title&gt;HelloWorld&lt;/title&gt;&lt;/head&gt;
        &lt;body&gt;
            &lt;%
                String str = "Hello World";
            %&gt;
            &lt;%=str %&gt; 
        &lt;/body&gt;
    &lt;/html&gt;'
    说明：脚本表达式翻译成对应java程序的代码放在该java程序的_jspService()方法中的print()方法中。
`</pre>

<html><br> <head></head><br> <body><br><br>## JSP页面的注释<br><br></body><br> </html>

<p>&lt;%–注释内容–%&gt;//jsp注释，注释内容不会翻译为java代码，浏览器和源码中无法看到。</p>
<!-- 注释内容 -->//HTML注释，会翻译为对应的java代码，在浏览器中注释的内容不会显示，查看源代码看得到注释的内容。<br>&lt;%//%&gt;、&lt;%/**/%&gt;//java注释，会翻译为java代码,但是不作为响应的内容，浏览器和源码中无法看到。<br><br>例子<br><br><pre><code>&#39;&amp;lt;html&amp;gt;
        &amp;lt;head&amp;gt;&amp;lt;title&amp;gt;HelloWorld&amp;lt;/title&amp;gt;&amp;lt;/head&amp;gt;
        &amp;lt;body&amp;gt;
            &amp;lt;% String str = &quot;aaa&quot;; %&amp;gt;
            &amp;lt;%--&amp;lt;%=str %&amp;gt; --%&amp;gt; //jsp注释
            &amp;lt;!--&amp;lt;%=str %&amp;gt; --&amp;gt;
    //HTML注释，无法在浏览器中看到，但可在网页源文件中看到&amp;lt;!--aaa--&amp;gt; 
            &amp;lt;% //String str2 = &quot;bbb&quot;; %&amp;gt; //java注释
        &amp;lt;/body&amp;gt;
    &amp;lt;/html&amp;gt;&#39;</code></pre><br><br><html><br> <head></head><br> <body><br><br># JSP指令元素<br><br></body><br> </html><br><br><pre><code>JSP指令元素&amp;lt;%@指令类型 属性名=”属性值”%&amp;gt;用于提供整个JSP页面的相关信息，用来设定JSP页面的相关属性。</code></pre><br><br>## Page指令<br><br><pre><code>page指令的功能是设定整个JSP页面的属性和相关功能，用于翻译阶段与web容器的通讯。</code></pre><br><br>语法：<a href="&#109;&#x61;&#105;&#x6c;&#116;&#x6f;&#58;&#x25;&#64;&#112;&#97;&#103;&#x65;&#x5c5e;&#24615;&#21517;&#61;&#x201d;&#23646;&#24615;&#x503c;&#8221;&#x25;">&#x25;&#64;&#112;&#97;&#103;&#x65;&#x5c5e;&#24615;&#21517;&#61;&#x201d;&#23646;&#24615;&#x503c;&#8221;&#x25;</a><br>对应的xml兼容格式语法为：&lt;jsp:directive.page属性名=”属性值”/&gt;<br><br>### Page指令的属性<br><br><table><br><tr><br><th>属性名</th><br><th>描述</th><br><th>默认值</th><br></tr><br><tr><br><td>language</td><br><td>脚本语言名称</td><br><td>“java”</td><br></tr><br><tr><br><td>info</td><br><td>网页信息</td><br><td>无</td><br></tr><br><tr><br><td>contentType</td><br><td>MIME类型及字符编码</td><br><td>“text/html;charset=ISO-8859-1”</td><br></tr><br><tr><br><td>import</td><br><td>类和包</td><br><td>none</td><br></tr><br><tr><br><td>buffer</td><br><td>缓冲区大小</td><br><td>8192k</td><br></tr><br><tr><br><td>autoFlush</td><br><td>自动刷新</td><br><td>true</td><br></tr><br><tr><br><td>session</td><br><td>能否获取session对象</td><br><td>true</td><br></tr><br><tr><br><td>isThreadSafe</td><br><td>是否线程安全</td><br><td>true</td><br></tr><br><tr><br><td>errorPage</td><br><td>指定错误页面</td><br><td>none</td><br></tr><br><tr><br><td>isErrorPage</td><br><td>允许为错误页面</td><br><td>false</td><br></tr><br><tr><br><td>extends</td><br><td>指定父类</td><br><td>无</td><br></tr><br></table><br><br>例子<br><br><pre><code>&#39;&amp;lt;%@page contentType=&quot;text/html; charset=utf-8&quot; info=&quot;aa&quot; %&amp;gt;
    &amp;lt;!--翻译成的java代码为response.setContentType(“text/html;charset=utf-8”)--&amp;gt;
    &amp;lt;%@page import=&quot;java.util.Date&quot;%&amp;gt;
    &amp;lt;!--翻译成的java代码为import java.util.Date--&amp;gt;
    &amp;lt;%@page import=&quot;java.text.SimpleDateFormat&quot;%&amp;gt;
    &amp;lt;html&amp;gt;
        &amp;lt;head&amp;gt;&amp;lt;title&amp;gt;pageTest&amp;lt;/title&amp;gt;&amp;lt;/head&amp;gt;
        &amp;lt;body&amp;gt;
            &amp;lt;% 
                Date date = new Date(); 
                SimpleDateFormat sd = new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;); 
             %&amp;gt;
            &amp;lt;h1&amp;gt;当前系统时间：&amp;lt;%=sd.format(date) %&amp;gt;&amp;lt;/h1&amp;gt;   
        &amp;lt;br&amp;gt;&amp;lt;/body&amp;gt;
    &amp;lt;/html&amp;gt;&#39;</code></pre><br><br>### include指令（静态包含）：<br><br>include指令用于在JSP编译阶段插入一个包含文本或代码的文件，将文件中的文本静态地包含进当前JSP文件中，如：&lt;%@include  file=”hello.jsp”%&gt;。静态包含的文本最好不要有HTML标签和body标签，因为被包含的文件的全部内容将被插入到JSP文件中include指令所在的地方，这些标签会同JSP文件中已有的同样的标签发生冲突，静态包含的文件名不能是变量名且不能传递参数。<br><br>### taglib指令<br><br>taglib指令能让用户在页面中使用自定义的标签。<br>语法：&lt;%@taglib  uri=”uri”  prefix=”tagPrefix”%&gt;<br>对应的xml兼容格式语法为：&lt;jsp:directive.taglib  uri=”uri” prefix=”tagPrefix”/&gt;<br><br>## JSP动作元素<br><br>JSP动作利用XML语法格式的标记来控制Servlet引擎的行为。利用JSP动作可以动态地插入文件、重用JavaBean组件、重定向用户到另外的页面、为java插件生成HTML代码、实现页面与组件的通信。<br><br>### <code>&amp;lt;jsp:include/&amp;gt;动作(动态包含):</code><br><br>语法: <code>&amp;lt;jsp:include page=&quot;localUrl&quot; flush=&quot;true&quot;/&amp;gt;</code>,flush为true表示缓冲区满时，自动刷新页面。<br><br>### <code>&amp;lt;jsp:forward/&amp;gt;动作（页面转发）：</code><br><br>语法：<code>&amp;lt;jsp:forward  page=”url”/&amp;gt;</code>，相当于RequestDispatcher的forward方法, 将请求转发出去。<br><br>## 动态包含和静态包含的区别<br><br>☆   根本区别在于包含的时机，静态包含是在编译期间包含，而动态包含是在运行期间包含。<br>☆   静态包含的是代码，动态包含的只是响应的内容。<br>☆   静态包含适用于包含静态页面，动态包含适用于包含动态页面。<br>☆   静态包含不能传递参数，动态包含可以传递参数。<br><br><pre><br><code>①    、编写includeTest1.jsp如下：
&amp;lt;body&amp;gt;
    &amp;lt;%
    int i=100;
    String str=&quot;includeTest1.jsp&quot;;
     %&amp;gt;
    &amp;lt;%=str %&amp;gt;中i值是：&amp;lt;%=i %&amp;gt;&amp;lt;br&amp;gt;
    &amp;lt;jsp:include page=&quot;includeTest2.jsp&quot;&amp;gt;&amp;lt;/jsp:include&amp;gt;
&amp;lt;/body&amp;gt;
再编写includeTest2.jsp如下：
&amp;lt;body&amp;gt;
    &amp;lt;%
    int i=600;
    String str=&quot;includeTest2.jsp&quot;;
     %&amp;gt;
    &amp;lt;%=str %&amp;gt;中i值是：&amp;lt;%=i %&amp;gt;
&amp;lt;/body&amp;gt;
启动tomcat，在浏览器中输入http://localhost:8080/myapp/includeTest1.jsp查看结果如下：
includeTest1.jsp中i值是：100
includeTest2.jsp中i值是：600
②   、将includeTest1.jsp改为如下：
&amp;lt;body&amp;gt;
    &amp;lt;%
    int i=100;
    String str=&quot;includeTest1.jsp&quot;;
     %&amp;gt;
    &amp;lt;%=str %&amp;gt;中i值是：&amp;lt;%=i %&amp;gt;&amp;lt;br&amp;gt;
 &amp;lt;%@ include  file=&quot;includeTest2.jsp&quot;%&amp;gt;
&amp;lt;/body&amp;gt;
将includeTest2.jsp改为如下：
&amp;lt;body&amp;gt;
    &amp;lt;%=str%&amp;gt;中i值是：&amp;lt;%=i %&amp;gt;
&amp;lt;/body&amp;gt;
在浏览器中输入：http://localhost:8080/myapp/includeTest1.jsp查看结果如下：
includeTest1.jsp中i值是：100
includeTest1.jsp中i值是：100
③   、从上例可知，动态包含时，包含和被包含的文件互不影响，只是将被包含文件编译执行后的结果放入了包含的文件中；静态包含相当于将被包含的文件中的文本直接放入了包含的文件中，然后编译执行。</code><br><br></pre><br><br>## JSP隐式对象<br><br>隐式对象就是不用实例化，可以直接在JSP页面中使用的对象，如下表所示：<br><br><table><br>  <tr><br>    <th>对象</th><br>    <th>描述</th><br>  </tr><br>  <tr><br>    <td>request</td><br>    <td>代表与请求相关的HttpServletRequest对象</td><br>  </tr><br>  <tr><br>    <td>response</td><br>    <td>代表与响应相关的HttpServletResponse对象</td><br>  </tr><br>  <tr><br>    <td>PageContext</td><br>    <td>代表封装请求某个JSP页面时请求环境的PageContext对象</td><br>  </tr><br>  <tr><br>    <td>session</td><br>    <td>代表特定用户请求会话的HttpSession对象</td><br>  </tr><br>  <tr><br>    <td>application</td><br>    <td>代表web应用程序的ServletContext对象</td><br>  </tr><br>  <tr><br>    <td>out</td><br>    <td>代表与响应输出流相关的jspWriter对象</td><br>  </tr><br>  <tr><br>    <td>config</td><br>    <td>代表JSP页面的Servlet相关的ServletConfig对象</td><br>  </tr><br>  <tr><br>    <td>page</td><br>    <td>等于java中的this变量</td><br>  </tr><br>  <tr><br>    <td>exception</td><br>    <td>JSP页面抛出的Throwable对象，这个对象只能在JSP错误页面中使用</td><br>  </tr><br></table><br><br>### out对象<br><br>out对象是一个输出缓冲流，用来给客户端返回信息，它是javax.servlet.jsp.JspWriter的一个实例。<br>out对象常用方法：<br>☆println()：向客户端输出各种类型的数据<br>☆newLine()：输出一个换行符<br>☆close()：关闭输出流<br>☆flush()：输出缓冲区里的数据<br>☆clearBuffer()：清除缓冲区里的数据，同时把数据输出到客户端<br>☆clear()：清除缓冲区里的数据，但不把数据输出到客户端<br>☆getBufferSize()：返回缓冲区的大小<br><br>### pageContext对象：<br><br>pageContext对象可以获取其他隐式对象、可以实现页面的转发和包含、可以用它对四个作用域空间进行数据的存取，它是javax.servlet.jsp.PageContext的实例。<br>①   pageContext对象获取其他隐式对象：<br>☆getRequest ：获得request隐式对象<br>☆getResponse：获得response隐式对象<br>☆getServletConfig：获得config隐式对象<br>☆getServletContext：获得application隐式对象<br>☆getPage：获得page隐式对象<br>☆getSession：获得session隐式对象<br>②pageContext对象对四个作用域空间进行数据的存取：<br>pageContext对象提供了四个常量，用来表示四个作用域：<br>☆PAGE_SCOPE：pageContext作用域，只在当前页面有效<br>☆REQUEST_SCOPE： request作用域，在forward转发的页面有效<br>☆SESSION_SCOPE：session作用域，IE浏览器未关闭就一直有效<br>☆APPLICATION_SCOPE：application作用域，未重启Tomcat就一直有效。<br>③pageContext对象实现页面的转发和包含：<br>pageContext.forward(String relativeURL);//实现页面的转发<br>pageContext.include(String relativeURL);//实现页面的包含<br><br>例子<br><br><pre><br><br><pre>`例1，获取web.xml配置文件中jsp的初始化参数：<br>先在tomcat安装目录下的webapps目录中新建/myapp/WEB-INF/路径，并在WEB-INF目录中编写web.xml如下：<br>&lt;?xml version=”1.0” encoding=”UTF-8”?&gt;<br>&lt;web-app version=”2.5”<br>    xmlns=”<a href="http://java.sun.com/xml/ns/javaee" target="_blank" rel="external">http://java.sun.com/xml/ns/javaee</a>“<br>    xmlns:xsi=”<a href="http://www.w3.org/2001/XMLSchema-instance" target="_blank" rel="external">http://www.w3.org/2001/XMLSchema-instance</a>“<br>    xsi:schemaLocation=”<a href="http://java.sun.com/xml/ns/javaee" target="_blank" rel="external">http://java.sun.com/xml/ns/javaee</a><br>    <a href="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd&quot;&amp;gt" target="_blank" rel="external">http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd&quot;&amp;gt</a>;<br>  &lt;servlet&gt;<br>    &lt;servlet-name&gt;param&lt;/servlet-name&gt;<br>    &lt;jsp-file&gt;/get.jsp&lt;/jsp-file&gt;&lt;!–指定jsp文件，路径相对于当前web项目文件夹–&gt;<br>    &lt;init-param&gt;&lt;!–JSP的初始化参数–&gt;<br>        &lt;param-name&gt;name&lt;/param-name&gt;<br>        &lt;param-value&gt;zhangsan&lt;/param-value&gt;<br>    &lt;/init-param&gt;<br>  &lt;/servlet&gt;<br>  &lt;servlet-mapping&gt;<br>    &lt;servlet-name&gt;param&lt;/servlet-name&gt;<br>    &lt;url-pattern&gt;/get.jsp&lt;/url-pattern&gt;<br><a href="!--http://localhost:8080/myapp/get.jsp对应该jsp--">!--http://localhost:8080/myapp/get.jsp对应该jsp--</a>
<p>  &lt;/servlet-mapping&gt;<br>&lt;/web-app&gt;<br>然后在myapp目录中编写get.jsp如下：<br>&lt;%@ page language=”java” import=”java.util.*” pageEncoding=”gbk”%&gt;<br>&lt;%<br>String path = request.getContextPath();<br>String basePath = request.getScheme()+”://“+request.getServerName()+”:”+request.getServerPort()+path+”/“;<br>%&gt;<br>&lt;html&gt;<br>  &lt;head&gt;</p>
<pre><code>&amp;lt;base href=&quot;&amp;lt;%=basePath%&amp;gt;&quot;&amp;gt;
&amp;lt;!--base标签设置当前页面的根路径，即当前页面的其他路径可以相对base标签设置的路径而设置--&amp;gt;
&amp;lt;title&amp;gt;My JSP &apos;forward.jsp&apos; starting page&amp;lt;/title&amp;gt;
</code></pre><p>&lt;%!<br>  public void jspInit() {//访问该jsp时执行该方法</p>
<pre><code>System.out.println(&quot;初始化&quot;);
</code></pre><p>}<br>public void jspDestroy() {//该jsp对应的Java程序(servlet)销毁时执行</p>
<pre><code>System.out.println(&quot;销毁&quot;);
</code></pre><p>}<br>%&gt;<br>  &lt;/head&gt;<br>&lt;body&gt;<br>&lt;%  </p>
<pre><code>String param = config.getInitParameter(&quot;name&quot;);
</code></pre><p>//获取web.xml中jsp的初始化参数</p>
<pre><code>out.println(&quot;param-value  in web.xml is :&quot;+param);
</code></pre><p>%&gt;&lt;br/&gt;</p>
<pre><code>basePath is  &amp;lt;%=basePath%&amp;gt;
</code></pre><p>  &lt;/body&gt;<br>&lt;/html&gt;<br>最后启动tomcat，在浏览器中输入：<a href="http://localhost:8080/myapp/get.jsp访问。" target="_blank" rel="external">http://localhost:8080/myapp/get.jsp访问。</a><br>`</p></pre><p></p>
<hr>
<p><pre>`例2，在request作用域中传递绑定的对象：<br>先在tomcat安装目录下的webapps目录中新建myapp目录，然后在myapp目录中编写sendEmp.jsp如下：<br>&lt;html&gt;<br>&lt;body&gt;<br>&lt;%<br>request.setAttribute(“emp”,”scott”);<br>%&gt; </pre></p>
<pre><code>&amp;lt;jsp:forward page=&quot;getEmp.jsp&quot;&amp;gt;&amp;lt;/jsp:forward&amp;gt;&amp;lt;!--请求转发--&amp;gt;
</code></pre><p>&lt;/body&gt;<br>&lt;/html&gt;<br>继续在myapp目录中编写getEmp.jsp如下：<br>&lt;%<br>String emp = (String)pageContext.getAttribute(“emp”,PageContext.REQUEST_SCOPE);<br>String emp2 = (String)request.getAttribute(“emp”);//这句和上句意思一样<br>out.println(emp+” “+emp2);<br>%&gt;<br>启动tomcat，在浏览器中输入：<a href="http://localhost:8080/myapp/sendEmp.jsp访问。" target="_blank" rel="external">http://localhost:8080/myapp/sendEmp.jsp访问。</a></p>
</pre></li>
</ol>
<p></p>
<p>##另外<br><a href="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160415131256.png" target="_blank" rel="external"><img src="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160415131256.png" alt="QQ截图20160415131256"></a></p>
<p><a href="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160415131316.png" target="_blank" rel="external"><img src="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160415131316.png" alt="QQ截图20160415131316"></a></p>
<p><a href="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160415131546.png" target="_blank" rel="external"><img src="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160415131546.png" alt="QQ截图20160415131546"></a></p>
<p><a href="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160415131616.png" target="_blank" rel="external"><img src="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160415131616.png" alt="QQ截图20160415131616"></a></p>
<p><a href="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160415131622.png" target="_blank" rel="external"><img src="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160415131622.png" alt="QQ截图20160415131622"></a></p>
<p><a href="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160415131628.png" target="_blank" rel="external"><img src="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160415131628.png" alt="QQ截图20160415131628"></a></p>
<p><a href="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160415131641.png" target="_blank" rel="external"><img src="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160415131641.png" alt="QQ截图20160415131641"></a></p>
<p><a href="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160415131648.png" target="_blank" rel="external"><img src="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160415131648.png" alt="QQ截图20160415131648"></a></p>
<p><a href="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160415131655.png" target="_blank" rel="external"><img src="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160415131655.png" alt="QQ截图20160415131655"></a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.iaihe.cn/blog/blog/2016/04/13/e9-9d-a2-e5-90-91-e5-af-b9-e8-b1-a1-e8-ae-be-e8-ae-a1-e5-8e-9f-e5-88-99/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zlshi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MarginStone's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2016/04/13/e9-9d-a2-e5-90-91-e5-af-b9-e8-b1-a1-e8-ae-be-e8-ae-a1-e5-8e-9f-e5-88-99/" itemprop="url">面向对象设计原则</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-04-13T12:35:50+08:00">
                2016-04-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/设计模式/" itemprop="url" rel="index">
                    <span itemprop="name">设计模式</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://coolshell.cn/articles/4535.html" target="_blank" rel="external">一些软件设计的原则</a><br><a href="http://www.importnew.com/10656.html" target="_blank" rel="external">面向对象设计原则和创建SOLID应用的5个方法</a></p>
<h1 id="迪米特法则"><a href="#迪米特法则" class="headerlink" title="迪米特法则"></a>迪米特法则</h1><h2 id="定义："><a href="#定义：" class="headerlink" title="定义："></a>定义：</h2><blockquote>
<p><strong>一个对象应该对其它对象保持最少的了解</strong>  从而降低类之间的耦合</p>
</blockquote>
<h3 id="具体来说对于对象-‘O’-中一个方法’M’，M应该只能够访问以下对象中的方法："><a href="#具体来说对于对象-‘O’-中一个方法’M’，M应该只能够访问以下对象中的方法：" class="headerlink" title="具体来说对于对象 ‘O’ 中一个方法’M’，M应该只能够访问以下对象中的方法："></a>具体来说对于对象 ‘O’ 中一个方法’M’，M应该只能够访问以下对象中的方法：</h3><ol>
<li>对象O</li>
<li>与O直接相关的Component Object</li>
<li>由方法M创建或者实例化的对象</li>
<li>作为方法M的参数的对象<br>例子：<a href="http://www.ccs.neu.edu/research/demeter/demeter-method/LawOfDemeter/paper-boy/demeter.pdf" target="_blank" rel="external">demeter</a></li>
</ol>
<h1 id="SOLID-原则"><a href="#SOLID-原则" class="headerlink" title="SOLID 原则"></a>SOLID 原则</h1><h2 id="单一职责-（SRP"><a href="#单一职责-（SRP" class="headerlink" title="单一职责 （SRP)"></a>单一职责 （SRP)</h2><p>一个类发生变化的原因不应该超过一个。这意味着代码中每个类，或者类似的结构只有一个功能。<br><a href="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160413142903.png" target="_blank" rel="external"><img src="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160413142903-300x117.png" alt="QQ截图20160413142903"></a></p>
<h2 id="里氏替换原则-（LSP"><a href="#里氏替换原则-（LSP" class="headerlink" title="里氏替换原则 （LSP)"></a>里氏替换原则 （LSP)</h2><p>子类必须能够替换成它们的基类。即：子类应该可以替换任何基类能够出现的地方，并且经过替换以后，代码还能正常工作。另外，不应该在代码中出现if/else之类对子类类型进行判断的条件。里氏替换原则LSP是使代码符合开闭原则的一个重要保证。正是由于子类型的可替换性才使得父类型的模块在无需修改的情况下就可以扩展。<br>A. Derived types must be completely substitutable for their base types<br>B. This principle is just an extension of the Open Close Principle<br>C. Making sure that new derived classes are extending the base classes without<br>changing their behavior</p>
<p><a href="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160413145728.png" target="_blank" rel="external"><img src="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160413145728-1024x531.png" alt="QQ截图20160413145728"></a></p>
<p><a href="http://blog.csdn.net/hguisu/article/details/7571617" target="_blank" rel="external">正方形不是矩形的例子</a></p>
<h2 id="接口隔离原则-（ISP"><a href="#接口隔离原则-（ISP" class="headerlink" title="接口隔离原则 （ISP)"></a>接口隔离原则 （ISP)</h2><p>接口隔离原则(Interface Segregation Principle)指出客户不应该被强迫依赖于他们不使用的接口。当我们使用非内聚的接口时，ISP指导我们创建多个较小的内聚度高的接口。</p>
<p>当你应用ISP时，类和他们的依赖使用紧密集中的接口通信，最大限度地减少了对未使用成员的依赖，并相应地降低耦合度。小接口更容易实现，提升了灵活性和重用的可能性。由于很少的类共享这些接口，为响应接口的变化而需要变化的类数量降低，增加了鲁棒性。</p>
<p>A. Clients should not be forced to depend upon interfaces that they don’t use</p>
<p><a href="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160413153256.png" target="_blank" rel="external"><img src="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160413153256.png" alt="QQ截图20160413153256"></a></p>
<p><a href="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160413153318.png" target="_blank" rel="external"><img src="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160413153318.png" alt="QQ截图20160413153318"></a></p>
<h2 id="依赖反转原则-（DIP"><a href="#依赖反转原则-（DIP" class="headerlink" title="依赖反转原则 （DIP)"></a>依赖反转原则 （DIP)</h2><p>依赖反转原则(Dependency Inversion Principle,DIP)指出高层次模块不应该依赖于低层次模块；他们应该依赖于抽象。第二，抽象不应该依赖于细节；细节依赖于抽象。方法是将类孤立在依赖于抽象形成的边界后面。如果在那些抽象后面所有的细节发生变化，那我们的类仍然安全。这有助于保持低耦合，使设计更容易改变。<br>A. High-level modules should not depend on low-level modules. Both should<br>depend on abstractions<br>B. Abstractions should not depend on details. Details should depend on<br>abstractions</p>
<p><a href="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160413154556.png" target="_blank" rel="external"><img src="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160413154556.png" alt="QQ截图20160413154556"></a></p>
<p><a href="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160413154612.png" target="_blank" rel="external"><img src="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160413154612.png" alt="QQ截图20160413154612"></a></p>
<p><a href="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160413155306.png" target="_blank" rel="external"><img src="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160413155306.png" alt="QQ截图20160413155306"></a></p>
<p><a href="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160413155326.png" target="_blank" rel="external"><img src="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160413155326.png" alt="QQ截图20160413155326"></a></p>
<h2 id="开闭原则（OCP"><a href="#开闭原则（OCP" class="headerlink" title="开闭原则（OCP)"></a>开闭原则（OCP)</h2><p>关于开发封闭原则，其核心的思想是：模块是可扩展的，而不可修改的。也就是说，对扩展是开放的，而对修改是封闭的。</p>
<p>对扩展开放，意味着有新的需求或变化时，可以对现有代码进行扩展，以适应新的情况。<br>对修改封闭，意味着类一旦设计完成，就可以独立完成其工作，而不要对类进行任何修改。</p>
<p>A. Software entities like classes, modules and functions should be open for<br>extensionbut closedformodifications<br>B. The design and writing of the code should be done in a way that new<br>nctionality should be added with minimum changes in the existing code<br>C. The design should be done in a way to allow the adding of new functionality as<br>new classes, keeping as much as possible existing code unchanged</p>
<p><a href="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160413160021.png" target="_blank" rel="external"><img src="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160413160021.png" alt="QQ截图20160413160021"></a></p>
<p><a href="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160413160030.png" target="_blank" rel="external"><img src="http://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160413160030.png" alt="QQ截图20160413160030"></a></p>
<h2 id="其它原则"><a href="#其它原则" class="headerlink" title="其它原则"></a>其它原则</h2><p>参考第一个链接一些软件设计的原则</p>
<ul>
<li>Common Closure Principle（CCP）– 共同封闭原则</li>
<li>Common Reuse Principle (CRP) – 共同重用原则</li>
<li>Hollywood Principle – 好莱坞原则</li>
<li>High Cohesion &amp; Low/Loose coupling &amp; – 高内聚， 低耦合</li>
<li>Convention over Configuration（CoC）– 惯例优于配置原则</li>
<li>Separation of Concerns (SoC) – 关注点分离</li>
<li>Design by Contract (DbC) – 契约式设计</li>
<li>Acyclic Dependencies Principle (ADP) – 无环依赖原则</li>
<li>Don’t Repeat Yourself (DRY)</li>
<li>Keep It Simple, Stupid (KISS)</li>
<li>Program to an interface, not an implementation</li>
<li>Command-Query Separation (CQS)  – 命令-查询分离原则</li>
<li>You Ain’t Gonna Need It (YAGNI)</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.iaihe.cn/blog/blog/2016/04/11/markdown-e4-bd-bf-e7-94-a8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zlshi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MarginStone's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2016/04/11/markdown-e4-bd-bf-e7-94-a8/" itemprop="url">Markdown使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-04-11T22:04:53+08:00">
                2016-04-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/工具软件学习/" itemprop="url" rel="index">
                    <span itemprop="name">工具软件学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://wowubuntu.com/markdown/index.html" target="_blank" rel="external">Markdown语法说明</a><br><a href="http://sspai.com/25137" target="_blank" rel="external">Markdown入门</a></p>
<h1 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h1><p>这是一个html书写的表格</p>
<table border="1"><br><thead><br><tr><br><th>标题1</th><br><th>标题2</th><br></tr><br></thead><br><tbody><br><tr><br><td>data1</td><br><td>data2</td><br></tr><br><tfoot><br><tr><br> <td>Sum</td><br> <td>$180</td><br></tr><br></tfoot><br></tbody><br></table>

<p>&copy;</p>
<h1 id="This-is-an-H1"><a href="#This-is-an-H1" class="headerlink" title="This is an H1"></a>This is an H1</h1><h2 id="This-is-an-H2"><a href="#This-is-an-H2" class="headerlink" title="This is an H2"></a>This is an H2</h2><h1 id="这是H1"><a href="#这是H1" class="headerlink" title="这是H1"></a>这是H1</h1><h2 id="这是H2"><a href="#这是H2" class="headerlink" title="这是H2"></a>这是H2</h2><h3 id="这是H3"><a href="#这是H3" class="headerlink" title="这是H3"></a>这是H3</h3><h6 id="这是H6"><a href="#这是H6" class="headerlink" title="这是H6"></a>这是H6</h6><blockquote>
<p>这是一段区块引用</p>
<p>  This is the first level of quoting.</p>
<blockquote>
<p>This is nested blockquote.</p>
</blockquote>
<p>  Back to the first level.</p>
<h2 id="这是一个标题"><a href="#这是一个标题" class="headerlink" title="这是一个标题"></a>这是一个标题</h2><ol>
<li>这是第一行列表项</li>
<li><p>这是第二行列表项</p>
<p>给出一些例子代码：<br>return shell_exec(“echo $input | $markdown_script”);</p>
</li>
</ol>
</blockquote>
<h3 id="markdown-支持有序列表和无序列表"><a href="#markdown-支持有序列表和无序列表" class="headerlink" title="markdown 支持有序列表和无序列表"></a>markdown 支持有序列表和无序列表</h3><h4 id="无序列表使用星号-加号或减号作为列表标记"><a href="#无序列表使用星号-加号或减号作为列表标记" class="headerlink" title="无序列表使用星号 加号或减号作为列表标记"></a>无序列表使用星号 加号或减号作为列表标记</h4><ul>
<li>Red</li>
<li>Green</li>
<li>Blue</li>
<li>Red</li>
<li>Green</li>
<li>Blue</li>
<li>Red</li>
<li>Green</li>
<li>Blue</li>
</ul>
<h4 id="有序列表使用数字接着一个英文句点"><a href="#有序列表使用数字接着一个英文句点" class="headerlink" title="有序列表使用数字接着一个英文句点"></a>有序列表使用数字接着一个英文句点</h4><ol>
<li>Bird</li>
<li>McHale</li>
<li>Parish</li>
</ol>
<ul>
<li>Lorem ipsum dolor sit amet, consectetuer adipiscing elit.<br>Aliquam hendrerit mi posuere lectus. Vestibulum enim wisi,<br>viverra nec, fringilla in, laoreet vitae, risus.</li>
<li>Donec sit amet nisl. Aliquam semper ipsum sit amet velit.<br>Suspendisse id sem consectetuer libero luctus adipiscing.</li>
</ul>
<ol>
<li>This is paragraph one<br>This is paragraph one…….</li>
<li>This is paragraph two</li>
</ol>
<h4 id="你可以在一行中用三个以上的星号、减号、底线来建立一个分隔线，行内不能有其他东西。你也可以在星号或是减号中间插入空格。"><a href="#你可以在一行中用三个以上的星号、减号、底线来建立一个分隔线，行内不能有其他东西。你也可以在星号或是减号中间插入空格。" class="headerlink" title="你可以在一行中用三个以上的星号、减号、底线来建立一个分隔线，行内不能有其他东西。你也可以在星号或是减号中间插入空格。"></a>你可以在一行中用三个以上的星号、减号、底线来建立一个分隔线，行内不能有其他东西。你也可以在星号或是减号中间插入空格。</h4><hr>
<p>分割</p>
<hr>
<p>分割</p>
<hr>
<p>分割</p>
<hr>
<p>This is <a href="https://www.baidu.com/" title="百度" target="_blank" rel="external">an example</a> inline link.</p>
<h4 id="插入图片"><a href="#插入图片" class="headerlink" title="插入图片"></a>插入图片</h4><p><img src="http://mouapp.com/Mou_128.png" alt="Mou icon"></p>
<h4 id="粗体与斜体"><a href="#粗体与斜体" class="headerlink" title="粗体与斜体"></a>粗体与斜体</h4><p>Markdown 的粗体和斜体也非常简单，用两个 <em> 包含一段文本就是粗体的语法，用一个 </em> 包含一段文本就是斜体的语法。<br><strong>这里是粗体</strong>  <em>这里是斜体</em></p>
<h4 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h4><p>‘Class Main{}’</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.iaihe.cn/blog/blog/2016/04/11/git-e5-9f-ba-e6-9c-ac-e6-93-8d-e4-bd-9c/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zlshi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MarginStone's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2016/04/11/git-e5-9f-ba-e6-9c-ac-e6-93-8d-e4-bd-9c/" itemprop="url">Git基本操作</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-04-11T15:08:26+08:00">
                2016-04-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/工具软件学习/" itemprop="url" rel="index">
                    <span itemprop="name">工具软件学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://marklodato.github.io/visual-git-guide/index-zh-cn.html#basic-usage" target="_blank" rel="external">图解Git</a><br><a href="http://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000/" target="_blank" rel="external">参考廖雪峰的Git教程</a><br><a href="http://www.oschina.net/question/31384_157479" target="_blank" rel="external">Git分支管理</a><br>初始化一个Git仓库，使用git init命令</p>
<p>添加文件到仓库：<br>        1 使用git add <file> 可反复添加多个文件<br>        2 使用git commit -m “information”</file></p>
<p>git status查看仓库状态</p>
<p>git diff filename 查看文件改动地方</p>
<p>git log查看历史纪录 git log –pretty=oneline</p>
<p>在Git中，用HEAD表示当前版本，也就是最新的提交</p>
<p>上一个版本就是HEAD^，上上一个版本就是HEAD^^，<br>当然往上100个版本写100个^比较容易数不过来，所以写成HEAD~100。</p>
<p>使用git reset –hard HEAD^回退到上个版本 其后也可以加版本号回退</p>
<p>Git提供了一个命令git reflog用来记录你的每一次命令</p>
<p>HEAD指向的版本就是当前版本，因此，Git允许我们在版本的历史之间穿梭，使用命令git reset –hard commit_id。</p>
<p>穿梭前，用git log可以查看提交历史，以便确定要回退到哪个版本。</p>
<p>要重返未来，用git reflog查看命令历史，以便确定要回到未来的哪个版本。</p>
<p>命令git checkout – readme.txt意思就是，把readme.txt文件在工作区的修改全部撤销，这里有两种情况：</p>
<p>一种是readme.txt自修改后还没有被放到暂存区，现在，撤销修改就回到和版本库一模一样的状态；</p>
<p>一种是readme.txt已经添加到暂存区后，又作了修改，现在，撤销修改就回到添加到暂存区后的状态。</p>
<p>总之，就是让这个文件回到最近一次git commit或git add时的状态。</p>
<p>当使用git add filename 之后再回退可以使用 git reset HEAD filename<br>git commit 之后需要版本回退 git reset –hard HEAD^ 或git reset –hard commit_id</p>
<p>删除文件：<br>      用命令git rm删掉，并且git commit<br>      用git checkout – filename 从版本库中还原到工作区<br>远程仓库：<br><a href="https://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160411150428.png" target="_blank" rel="external"><img src="https://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160411150428-300x35.png" alt="QQ截图20160411150428"></a></p>
<p><a href="https://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160411151412.png" target="_blank" rel="external"><img src="https://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160411151412-300x66.png" alt="QQ截图20160411151412"></a></p>
<p><a href="https://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160411153700.png" target="_blank" rel="external"><img src="https://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160411153700-300x125.png" alt="QQ截图20160411153700"></a></p>
<p><a href="https://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160411170400.png" target="_blank" rel="external"><img src="https://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160411170400-300x181.png" alt="QQ截图20160411170400"></a></p>
<p><a href="https://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160411172123.png" target="_blank" rel="external"><img src="https://zlshi.blog.ustc.edu.cn/wp-content/uploads/2016/04/QQ截图20160411172123-300x63.png" alt="QQ截图20160411172123"></a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.iaihe.cn/blog/blog/2015/10/17/e8-ae-b0-e5-bf-86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zlshi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MarginStone's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2015/10/17/e8-ae-b0-e5-bf-86/" itemprop="url">记忆</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-10-17T13:42:10+08:00">
                2015-10-17
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/只如初见/" itemprop="url" rel="index">
                    <span itemprop="name">只如初见</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>只如初见</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.iaihe.cn/blog/blog/2015/10/17/hello-world-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zlshi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MarginStone's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/blog/2015/10/17/hello-world-1/" itemprop="url">世界，你好！</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-10-17T00:50:49+08:00">
                2015-10-17
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/问题笔记/" itemprop="url" rel="index">
                    <span itemprop="name">问题笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>欢迎使用 WordPress。这是系统自动生成的演示文章。编辑或者删除它，然后开始您的博客！</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/blog/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/blog/">1</a><span class="page-number current">2</span>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
      <div id="sidebar-dimmer"></div>
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/blog/images/avatar.jpg"
                alt="zlshi" />
            
              <p class="site-author-name" itemprop="name">zlshi</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/blog/archives/">
              
                  <span class="site-state-item-count">20</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/blog/categories/index.html">
                  <span class="site-state-item-count">9</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/blog/tags/index.html">
                  <span class="site-state-item-count">16</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/zlshi" target="_blank" title="GitHub">
                    
                      <i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:zlshi9219@gmail.com" target="_blank" title="E-Mail">
                    
                      <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">zlshi</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.3</div>




        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/blog/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/blog/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/blog/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/blog/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/blog/js/src/schemes/pisces.js?v=5.1.3"></script>



  

  


  <script type="text/javascript" src="/blog/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  
    

    
  





  









<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="//unpkg.com/valine/dist/Valine.min.js"></script>



  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/blog/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
